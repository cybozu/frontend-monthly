---
title: Cybozu Frontend Monthly
date: "2021-08-31T17:00:00+09:00"
slug: "2021-08"
connpass: "https://cybozu.connpass.com/event/222354/"
streamUrl: "https://www.youtube.com/watch?v=Rp6yNsHgxhY"
no: 14
members:
  - name: "@koba04"
    link: https://twitter.com/koba04
  - name: "@__sakito__"
    link: https://twitter.com/__sakito__
  - name: "@nakajmg"
    link: https://twitter.com/nakajmg
  - name: "@b4h0_c4t"
    link: https://twitter.com/b4h0_c4t
  - name: "@__sosukesuzuki"
    link: https://twitter.com/__sosukesuzuki
  - name: "@mugi_uno"
    link: https://twitter.com/mugi_uno
  - name: "@sajikix"
    link: https://twitter.com/sajikix
guest:
---

### [Safari isn't protecting the web, it's killing it](https://httptoolkit.tech/blog/safari-is-killing-the-web/)

- å…±æœ‰è€…: nakajmg

SafariãŒã‹ã¤ã¦ã®IEã¨åŒã˜ã‚ˆã†ãªå­˜åœ¨ã«ãªã£ã¦ãã¦ã„ã‚‹ã€webã‚’æ®ºã—ã¦ã„ã‚‹ã®ã§ã¯ãªã„ã‹ã¨ã„ã†è­°è«–ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚

Safariã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚„ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã«æ‡¸å¿µãŒã‚ã£ãŸã‚Šã€å®Ÿé¨“çš„ãªæ©Ÿèƒ½ã‚’è¿½åŠ ã—ãªã„ã“ã¨ã§Webã‚’ä¿è­·ã—ã¦ã„ã‚‹ã¨ã„ã†ã‚ˆã†ãªèªè­˜ã‚’æŒãŸã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã¯ç¾åœ¨ã§ã¯ã»ã¨ã‚“ã©é–“é•ã£ã¦ã„ã‚‹ã¨ç´¹ä»‹ã—ã¦ã„ã¾ã™ã€‚

å…·ä½“çš„ã«ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ãŒå®Ÿè£…ã—ã¦ã„ã¦SafariãŒå®Ÿè£…ã—ã¦ã„ãªã„æ©Ÿèƒ½ã¨ã—ã¦æ¬¡ã®ã‚‚ã®ãŒã‚ã’ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

- CSS's contain property: Chrome(2016) Firefox(2019)
- CSS's offset-path property: Chrome(2015) Firefox(2020)
- CSS's overflow-anchor property: Chrome(2017) Firefox (2019)
- Resolution media queries: Firefox(2012) Chrome(2013)
- `:focus-visible`: Chrome(2020) FirefoxJanuary (2021)
- TouchEvents: Chrome(2012) Firefox(2017)
- BroadcastChannel: Firefox(2015) Chrome(2016)
- beforeprint and afterprint JavaScript events: IE 6(2001) Firefox(2011) Chrome(2018)
- Regex lookbehind in JavaScript: Chrome(2017) Firefox(2020)
- `scrollIntoView({ behavior: 'smooth' })`: Firefox(2015) Chrome(2017)
- Screen orientation JavaScript APIs: Chrome(2014) Firefox(2016)
- AV1 video and AVIF images: Chrome(2018) Firefox(2019)

ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã¯Safariä»¥å¤–ã®å¤šãã®ãƒ–ãƒ©ã‚¦ã‚¶ãŒå®Ÿè£…ã—ã¦ã„ã¾ã™ãŒã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ãƒãƒƒãƒ†ãƒªãƒ¼å¯¿å‘½ã¸ã®æ‡¸å¿µãªã©ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

å®Ÿè£…ã—ã¦ã„ãªã„æ©Ÿèƒ½ã ã‘ã§ã¯ãªãã€å¤šãã®ãƒã‚°ãŒæœªä¿®æ­£ã®ã¾ã¾ã§ã‚ã‚‹ã“ã¨ã‚‚å•é¡Œã¨ã—ã¦ã‚ã’ã¦ã„ã¾ã™ã€‚ã•ã‚‰ã«ã“ã‚Œã¯Safariã®ãƒªãƒªãƒ¼ã‚¹ã‚µã‚¤ã‚¯ãƒ«ãŒ6ãƒ¶æœˆã¨ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ã«æ¯”ã¹ã¦ã‚‚æ¥µç«¯ã«ãƒšãƒ¼ã‚¹ãŒé…ã„ã“ã¨ã§å•é¡ŒãŒæ‚ªåŒ–ã—ã¦ã„ã¾ã™ã€‚
Safariã§æ·±åˆ»ãªãƒã‚°ãŒè¦‹ã¤ã‹ã£ã¦ã™ãã«ä¿®æ­£ã•ã‚ŒãŸã¨ã—ã¦ã‚‚ã€ãã‚ŒãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹ã®ãŒ6ãƒ¶æœˆå¾Œã¨ã„ã†ã“ã¨ãŒèµ·ã“ã£ã¦ã„ã¾ã™ã€‚

è¨˜äº‹ã§ã¯Chromiumã®å¸‚å ´ã‚·ã‚§ã‚¢ã«ã¤ã„ã¦ã‚‚è§¦ã‚Œã¦ã„ã¦ã€ã“ã®ã¾ã¾ã§ã¯æ„å›³ã›ãšã¨ã‚‚ChromiumãŒå¸‚å ´ã‚’ç‹¬å ã—ã€çµæœçš„ã«ChromiumãŒå®Ÿè£…ã—ãŸã‚‚ã®ãŒå®Ÿè³ªçš„ãªwebæ¨™æº–ã¨ã—ã¦å—ã‘å…¥ã‚Œã–ã‚‹ã‚’å¾—ãªã„ã‚ˆã†ãªçŠ¶æ³ã«ãªã‚‹ã“ã¨ã‚’å±æƒ§ã—ã¦ã„ã¾ã™ã€‚

åˆ†é‡ã®å¤šã„è¨˜äº‹ã§ã™ãŒã€webãƒ–ãƒ©ã‚¦ã‚¶ã‚’å–ã‚Šå·»ãç¾çŠ¶ãŒæŠŠæ¡ã§ãã‚‹è‰¯ã„è¨˜äº‹ãªã®ã§ã€ãœã²èª­ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚

---

### [JavaScriptã‚¯ã‚¤ã‚º](https://twitter.com/tkihira/status/1429061261895946240)

[@tkihira](https://twitter.com/tkihira)ã•ã‚“ãŒä½•ä»¶ã‹ãƒ„ã‚¤ãƒ¼ãƒˆã—ã¦ã„ã‚‹JavaScriptã‚¯ã‚¤ã‚ºãŒé¢ç™½ã‹ã£ãŸã®ã§ã”ç´¹ä»‹ã—ã¾ã™ã€‚
ï¼ˆã”æœ¬äººã«è¨±å¯ã„ãŸã ãã¾ã—ãŸï¼ï¼‰

**asyncãƒ»awaitãƒ»Promise ã«é–¢ã™ã‚‹ã‚¯ã‚¤ã‚º**

ğŸ”— å…ƒãƒ„ã‚¤ãƒ¼ãƒˆ: https://twitter.com/tkihira/status/1429061261895946240

```
// ã©ã†ã„ã†é †ç•ªã§è¡¨ç¤ºã•ã‚Œã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ
console.log(1);
(async () => {
  console.log(2);
  await new Promise(r => {
    setTimeout(r, 1000);
    console.log(3);
  });
  console.log(4);
})();
console.log(5);
```

1. 1â†’2â†’3â†’4â†’5
2. 1â†’2â†’3â†’5â†’4
3. 1â†’5â†’2â†’3â†’4
4. 1â†’5â†’2â†’4â†’3


**forãƒ«ãƒ¼ãƒ—å‡¦ç†ã¨å¤‰æ•°ã«é–¢ã™ã‚‹ã‚¯ã‚¤ã‚º**

ğŸ”— å…ƒãƒ„ã‚¤ãƒ¼ãƒˆ: https://twitter.com/tkihira/status/1429625115038289922

```
// ä½•ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ
const a = [];
for (let i = 0; i < 9; i++) {
  a[i] = () => console.log("i: " + i);
}

const b = [];
let j = 0;
while (j < 9) {
  b[j] = () => console.log("j: " + j);
  j++;
}

a[2]();
a[5]();
b[2]();
b[5]();
```

1. i: 2, i: 5, j: 2, j: 5
2. i: 9, i: 9, j: 9, j: 9
3. i: 2, i: 5, j: 9, j: 9
4. i: 9, i: 9, j: 2, j: 5


ã‚·ãƒ³ãƒ—ãƒ«ãªãŒã‚‰ç†è§£åº¦ã‚’è©¦ã•ã‚Œã‚‹è‰¯ã„å†…å®¹ã ã¨æ€ã„ã¾ã—ãŸã€‚
ã¡ãªã¿ã«è‡ªåˆ†ã¯foræ–‡ã®ã»ã†ã‚’æ™®é€šã«é–“é•ãˆã¦ã—ã¾ã„ã€å¾Œã§å®Ÿè¡Œã—ã¦ã¿ã¦ã€Œã‚ãƒ¼ãƒ¼ï¼ï¼ã€ã¨ãªã‚Šã¾ã—ãŸã€‚ä¿®è¡Œã—ç›´ã—ã¦ãã¾ã™ã€‚

ä»–ã«ã‚‚ä½•å•ã‹æŒ™ã’ã‚‰ã‚Œã¦ã„ãŸã®ã§ã€ä¸€åº¦è¦‹ã¦ã¿ã‚‹ã¨æ¥½ã—ã„ã¨æ€ã„ã¾ã™ï¼

ğŸ”— æµ®å‹•å°æ•°ç‚¹å€¤ã®è¨ˆç®—ã«é–¢ã™ã‚‹ã‚¯ã‚¤ã‚º  
https://twitter.com/tkihira/status/1430001334116261890  
ğŸ”— use strict"ã®æŒ™å‹•ã«é–¢ã™ã‚‹ã‚¯ã‚¤ã‚º  
https://twitter.com/tkihira/status/1430366880833806337  

---

### [Next.js + Svelteã«ã‚ˆã‚‹noteã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰Appåˆ†å‰²](https://note.jp/n/n7f757d7050f6)

- å…±æœ‰è€…: kozo002

å·¨å¤§åŒ–ã—ãŸNuxt.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Next.js + Svelteã‚’ä½¿ã„åˆ†å‰²ã«å–ã‚Šçµ„ã‚“ã§ã„ã‚‹è©±ã‚’ç™ºè¡¨ã—ã¾ã—ãŸã€‚

---

### [[WIP] é•ã„ã§ã‚ã‹ã‚‹Svelte](https://note.zochang.com/n/n09c112297fe4)

- å…±æœ‰è€…: kozo002

ã¿ã‚“ãªå¤§å¥½ãReact/Vueã¨æ¯”è¼ƒã—ã¦Svelteã§ã¯ã©ã†ã‚„ã‚‹ã®ï¼Ÿã§Svelteã®ã“ã¨ã‚’ã‚ã‹ã£ãŸæ°—ã«ãªã‚‹ãŸã‚ã®è¨˜äº‹ã§ã™ã€‚

---

### [Agenda for the 85th meeting of Ecma TC39](https://github.com/tc39/agendas/blob/master/2021/08.md)

- å…±æœ‰è€…: @sosukesuzuki

8æœˆã®TC39ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ã‚¢ã‚¸ã‚§ãƒ³ãƒ€ã€‚

#### For Stage 4

ï¼“ã¤ã‚ã£ã¦ã™ã”ã„ï¼

##### [Array.prototype.at](https://github.com/tc39/proposal-relative-indexing-method)

é…åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å¯¾å¿œã—ãŸå€¤ã‚’å–å¾—ã™ã‚‹ã€‚è² ã®æ•´æ•°ã‚’æ¸¡ã™ã“ã¨ã§å¾Œã‚ã‹ã‚‰å–å¾—ã§ãã‚‹ã€‚

```js
console.log([1, 2, 3, 4, 5].at(-1)); // 5
```

##### [Object.hasOwn](https://github.com/tc39/proposal-accessible-object-hasownproperty)

`Object.prototype.hasOwnProperty.call` ãŒ `Object.hasOwn` ã§æ¸ˆã‚€ã‚ˆã†ã«ãªã‚‹ã€‚

##### [Class Static Blocks](https://github.com/tc39/proposal-class-static-block)

static ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ–ãƒ­ãƒƒã‚¯ã®æ§‹æ–‡ã€‚
è¤‡é›‘ãªå‡¦ç†ã®çµæœã‚„ã€ã‚¯ãƒ©ã‚¹ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä¾å­˜ã—ãŸè¨ˆç®—ã®çµæœã‚’ static ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
TypeScript 4.4 ã«å…¥ã£ãŸã€‚

```js
class Foo {
  static y;
  static {
    this.y = "y";
  }
}
```

ãã®ä»–åƒ•ãŒæ°—ã«ãªã£ãŸã‚‚ã®ã‚’ã„ãã¤ã‹

#### For Stage 3

##### [Iterator Helpers](https://github.com/tc39/proposal-iterator-helpers)

Array ã«ç”Ÿãˆã¦ã„ã‚‹ map ã¨ã‹ filter ã¿ãŸã„ãªä¾¿åˆ©ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿å…¨èˆ¬ã«å¯¾ã—ã¦ç”Ÿã‚„ã™ææ¡ˆã€‚ã»ã—ã„ï¼

#### For Stage 2

##### [Change Array by Copy](https://github.com/tc39/proposal-change-array-by-copy)

ã‚‚ã¨ã®é…åˆ—ã‚’å¤‰æ›´ã›ãšã«ã€é…åˆ—ã«å¯¾ã—ã¦ãªã‚“ã‚‰ã‹ã®æ“ä½œã‚’è¡Œã†ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã€‚
ã¿ã‚“ãªã»ã—ã„ã‚„ã¤ã€‚

```js
const arr1 = [1, 2, 3];
const arr2 = arr1.withPushed(4);
console.log(arr1); // [1, 2, 3]
console.log(arr2); // [1, 2, 3, 4] 
```

##### [Pipeline operators](https://github.com/tc39/proposal-pipeline-operator)

ã¿ã‚“ãªã»ã—ã„ã®ã‹ï¼Ÿæ˜”ã‹ã‚‰ã‚ã‚‹ã‚„ã¤ãŒæ–°ã—ããªã£ã¦ã„ã‚‹ã€‚

2018å¹´ã®æ™‚ç‚¹ã§2ã¤ã®ææ¡ˆã«åˆ†ã‹ã‚Œã¦ã„ãŸ(https://babeljs.io/blog/2018/07/19/whats-happening-with-the-pipeline-proposal)

2021å¹´ã§ã¯ Smart ãŒãªããªã£ã¦ Hack ãŒè¿½åŠ ã•ã‚ŒãŸã€‚

ãªã®ã§ã€ä»Šã¯ F# ã¨ Hack ãŒå­˜åœ¨ã™ã‚‹ã€‚

ã—ã‹ã—ã€Hack ã‚’é€²ã‚ã¦ã„ãæ–¹é‡ã‚‰ã—ã„ã€‚

ã“ã†ã„ã†ã‚„ã¤ã€‚

```js
return list
  |> take(prefix.length, %)
  |> equals(%, prefix);
```

ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ã¯ä»Šã®ã¨ã“ã‚ `%` ã ã‘ã©ã€ã¾ã è­°è«–ã•ã‚Œã¦ã„ã¦ã€ç¢ºå®šã§ã¯ãªã„ã€‚
`#` ã¨ã‹ `?` ã¨ã‹ã‚‚ã‚ã‚Šã‹ã‚‚ã­ï¼Ÿ

#### For Stage 1

##### [Get Intrinsic](https://github.com/ljharb/proposal-get-intrinsic)

ECMA262 Editor ã® @ljharb ã‚ãŸã‚‰ã—ã„ææ¡ˆã€‚

ä»Šã® JS ã¯ã“ã†ã„ã†ã“ã¨ãŒã§ãã¦ã—ã¾ã†ã€‚`String` ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ String ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã ã‘ã©ã€æ›¸ãæ›ãˆã‚‰ã‚Œã‚‹ã€‚

```js
function getString(value) {
  return String(value);
}

const foo = getString(3);
console.log(typeof foo === "string"); // true

String = Number;

const bar = getString(2);
console.log(typeof bar === "string"); // false
```

å›°ã‚‹ã®ã§ã€çµ„ã¿è¾¼ã¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ([Well-known Intrinsic Objects](https://tc39.es/ecma262/#sec-well-known-intrinsic-objects))ã‚’å®‰å…¨ã«å–å¾—ã™ã‚‹æ–¹æ³•ãŒã»ã—ã„ã€‚`getIntrinsic`ã€‚

```js
const $String = getIntrinsic("%String%");

function getString(value) {
  return $String(value);
}

const foo = getString(3);
console.log(typeof foo === "string"); // true

String = Number;

const bar = getString(2);
console.log(typeof bar === "string"); // true
```

@ljharb ãŒãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã—ã¦ã„ã‚‹ es-shims ã§ã¯ã€ãŠæ‰‹è£½ã® [get-intrinsic](https://www.npmjs.com/package/get-intrinsic) ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚(Weekly Download 12,873,582)

##### [String is USV String](https://github.com/guybedford/proposal-is-usv-string)

ECMAScript Modules ç•Œéšˆã§ã¯æœ‰åãª Guy Bedford ã®ææ¡ˆã€‚

æ–‡å­—åˆ—ãŒ USV String ã‹ã©ã†ã‹åˆ¤å®šã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å°å…¥ã™ã‚‹ã‚‰ã—ã„ï¼Ÿ

---
