---
title: Cybozu Frontend Monthly
date: "2021-06-29T17:00:00+09:00"
slug: "2021-06"
connpass:
streamUrl:
no: 12
members:
  - name: "@koba04"
    link: https://twitter.com/koba04
  - name: "@pirosikick"
    link: https://twitter.com/pirosikick
  - name: "@__sakito__"
    link: https://twitter.com/__sakito__
  - name: "@shisama_"
    link: https://twitter.com/shisama_
  - name: "@nakajmg"
    link: https://twitter.com/nakajmg
  - name: "@b4h0_c4t"
    link: https://twitter.com/b4h0_c4t
  - name: "@__sosukesuzuki"
    link: https://twitter.com/__sosukesuzuki
  - name: "@mugi_uno"
    link: https://twitter.com/mugi_uno
guest:
  - name: "@hokaccha"
    link: https://twitter.com/hokaccha
---

### [Storybook 6.3](https://storybook.js.org/blog/storybook-6-3/)

- 共有者: shisama

Storybook 6.3がリリースされたのでざっくりまとめです。

個人的にはwebpack 5のサポートがstableになって嬉しいのですが、その他にも便利そうな機能やStorybook7.0に関する言及もありました。

#### レイアウトに関する情報を確認することができる
- [Measure](https://storybook.js.org/addons/@storybook/addon-measure)
  - width, height, marginなどが確認できる
- [Outline](https://storybook.js.org/addons/@storybook/addon-outline)
  - CSSのレイアウトやアラインメントを視覚的に確認できるように各要素にボーダーを付けることができる
- [Viewport](https://storybook.js.org/addons/@storybook/addon-viewport)
  - ブラウザのDevToolsのスマホやタブレットのviewportに切り替えて表示する機能のようなことができる
    - この機能自体はすでにある
    - キーボードショートカットが使えるようになった
  
  ![viewport.png](https://github.com/storybookjs/storybook/blob/main/addons/viewport/docs/viewport.png)
  
  ([Viewport](https://storybook.js.org/addons/@storybook/addon-viewport)のページの画像がMIME Typeがあってなくて表示されていない...)
  
#### ストーリーをテストで再利用できる

- 作成したストーリーのファイルをテストコードからimportして使える
- `composeStories`でストーリーを取得してそれをレンダリングした結果を検証する
- 参考: [How to use Testing Library to test Storybook | Storybook](https://medium.com/storybookjs/testing-lib-storybook-react-8c36716fab86)

```jsx
import React from 'react';
import { render, screen } from '@testing-library/react';
import { composeStories } from '@storybook/testing-react';

// import Button stories file as a module
import * as stories from './Button.stories';

// Every component that is returned maps 1:1 with the stories, but they already contain all decorators from story level, meta level and global level!
const { Default, Disabled } = composeStories(stories);

test('renders button with custom children', () => {
  render(<Default />);
  expect(screen.getByText(/Hello world/i)).not.toBeNull(); // Hello world is already defined in the story args!
});
```
  
#### webpack 5サポートがstableになった
  - 6.2 ではexperimentalだった
  - webpack 5はまだOpt-in形式
    - デフォルトはwebpack 4
    - @storybook/manager-webpack5 が必要
    - Storybook 7.0からはwebpack 5がデフォルトになる
  - webpack 4へのアップグレートに関する参考: https://gist.github.com/shilman/8856ea1786dcd247139b47b270912324
  
  #### ESModulesを使った読み込み
  - `--modern`というオプションを付けて実行すると ESM が使われる
  - パフォーマンス
  - Storybook 7.0からdevelopment modeはESMがデフォルトになる予定
    - StorybookをIEから見る人いなければ影響はなさそう
    - 読み込み順序に依存している場合は壊れそう
    
#### その他追加機能
- Angular 12とLit 2がサポートされた
- ビルドツールにVite が使えるようになった

#### 参考

- 6.2 -> 6.3 のマイグレーションについては[MIGRATION.md](https://github.com/storybookjs/storybook/blob/next/MIGRATION.md)に記載されている
- Storybook 7.0については [このissue](https://github.com/storybookjs/storybook/issues/13491) にサマリーがある


---
