---
title: Cybozu Frontend Monthly
date: "2020-10-27T17:00:00+09:00"
connpass: "https://cybozu.connpass.com/event/192820/"
hashTag: "#ã‚µã‚¤ãƒœã‚¦ã‚ºãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒãƒ³ã‚¹ãƒªãƒ¼"
no: 4
guest:
  - name: "@koh110"
    link: https://twitter.com/koh110
  - name: "@narirow"
    link: https://twitter.com/narirow
---

### [LibSass is Deprecated ](https://sass-lang.com/blog/libsass-is-deprecated)

- å…±æœ‰è€…: @b4h0_c4t

LibSassãŒéæ¨å¥¨ã«ãªã£ãŸè©±ã€‚

é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Š

- æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯[DartSass](https://sass-lang.com/dart-sass)ã‚’æ¨å¥¨
- æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚‚è¨ˆç”»çš„ãªDartSassã¸ã®ç§»è¡Œã‚’æ¨å¥¨
- ä»Šå¾Œæ–°æ©Ÿèƒ½ã«å¯¾å¿œã™ã‚‹äºˆå®šã¯ãªã„
- Node Sassã‚‚å«ã‚ã€ä¸»è¦ãªãƒã‚°ã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»æœ€æ–°ã®Node.jsã¨ã®äº’æ›æ€§å¯¾å¿œã¯ç„¡æœŸé™ã§ç¶™ç¶šã•ã‚Œã‚‹ã€‚

ç¾çŠ¶ã®å®Ÿè£…ã§ã¯ã€min() max()ãªã©ã®ä¸€éƒ¨PlainCSSã‚„Sass module systemã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚‰ãšã€DartSassã¨ã®å…¼ã­åˆã„ã‚’é‘‘ã¿ã¦LibSasså´ã‚’éæ¨å¥¨ã«ã—ãŸã‚‰ã—ã„ã€‚

ç„¡æœŸé™ã«ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚’ç¶šã‘ã‚‹ã¨è¨€ã£ã¦ã„ã‚‹ãŒã€ã‚³ã‚¢ãƒãƒ¼ãƒ å´ã¯å¼·ãDartSassã¸ã®ç§»è¡Œã‚’å¼·èª¿ã—ã¦ã„ã‚‹ãŸã‚ã€ä½¿ã£ã¦ã„ã‚‹äººã¯æ—©ã‚ã«ç§»è¡Œã‚’å§‹ã‚ãŸæ–¹ãŒè‰¯ã•ãã†ã€‚

---

### [Svelte Summit | Rich Harris: Futuristic Web Development](https://youtu.be/qSfdtmcZ4d0)

- å…±æœ‰è€…: @toshi__toma

10/18ã«Svelteã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã€ŒSvelte Summitã€ãŒé–‹å‚¬ã•ã‚ŒãŸã€‚
ãã®ä¸­ã®ã€ŒRich Harris: Futuristic Web Developmentã€ãŒé¢ç™½ã‹ã£ãŸã®ã§ç´¹ä»‹ã€‚

Rich Harris: Futuristic Web Development
- ä¸»ã«Svelteã®ä»Šå¾Œã®é–‹ç™ºç’°å¢ƒã«ã¤ã„ã¦ã®è©±
- â€» å…¬å¼ã®ç™ºè¡¨ã§ã‚‚ãªã„ã—ã€ä¿è¨¼ã™ã‚‹ã‚ã‘ã§ã¯ãªã„
- Svelteãƒ™ãƒ¼ã‚¹ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ Sapper(Reactã§ã„ã†Next.js)ã®v1ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã‚‹ã“ã¨ã¯ãªã„
- Sapperã®ä»£ã‚ã‚Šã«ã€ [@sveltejs/kit](https://www.npmjs.com/package/@sveltejs/kit)ã‚’é–‹ç™ºã—ã¦ã‚‹(ã¾ã ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒª)
- é€”ä¸­ã‹ã‚‰ã¯ã€@sveltejs/kitã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒªé–‹ç™ºã®ãƒ‡ãƒ¢
- Rollupã§ã¯ãªãã€[Snowpack](https://www.snowpack.dev/)ã‚’ä½¿ã£ãŸé–‹ç™ºã«ãªã‚‹
- adapterã¨ã„ã†ä»•çµ„ã¿ãŒã‚ã£ã¦ã€ãã‚Œã§ãƒ“ãƒ«ãƒ‰ã®å‡ºåŠ›ã‚’å¤‰æ›´ã§ãã‚‹
  - node, static, Netlifyã€ãã®ä»–ãƒ¡ã‚¸ãƒ£ãƒ¼ãªFaasã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹äºˆå®š

ã‚ã¨ã€ä»Šæœˆã‹ã‚‰Monthlyã§æ–°æ©Ÿèƒ½ã‚„ãƒã‚°ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãªã©ã‚’ç´¹ä»‹ã™ã‚‹ "What's new in Svelte" ã‚·ãƒªãƒ¼ã‚ºãŒå§‹ã¾ã£ãŸã€‚

[What's new in Svelte: October 2020](https://svelte.dev/blog/whats-new-in-svelte-october-2020)

---

### [Node v15.0.0 (Current) | Node.js](https://nodejs.org/en/blog/release/v15.0.0/)

- å…±æœ‰è€…: @shisama_

10/20 ã« Node.js v15 ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸï¼å¤§ããªå¤‰æ›´ã‚‚å¤šã„ã§ã™ã€‚

- npm 7
- V8 v8.6 ES2021 ã®æ©Ÿèƒ½è¿½åŠ 
  - Promise.any and AggregateError
  - String.prototype.replaceAll
  - Logical assignment operators
- Web Crypto API ã®è¿½åŠ 
- AbortController ã®è¿½åŠ 
- EventTarget ã®è¿½åŠ 
- Unhandled Rejections ãŒç™ºç”Ÿã—ãŸã¨ãã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã‚ˆã†ã«å¤‰æ›´ï¼ˆçµ‚äº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ 1 ã«å¤‰ã‚ã‚‹ï¼‰
- QUIC ã®å®Ÿé¨“çš„å®Ÿè£…
- timers/promises ã®è¿½åŠ 
- stream/promises ã®è¿½åŠ 
- require('assert').strict ã‚’ require('assert/strict') ã§èª­ã¿è¾¼ã‚€
- require('dns').promises ã‚’ require('dns/promises') ã§èª­ã¿è¾¼ã‚€
- file URL ã®ä»•æ§˜è¿½éš

æ—¥æœ¬èªè¨˜äº‹
- [Node.js v15 ã®ä¸»ãªå¤‰æ›´ç‚¹ - åˆ¥ã«ã—ã‚“ã©ããªã„ãƒ–ãƒ­ã‚°](https://shisama.hatenablog.com/entry/2020/10/21/004612)
- [10æœˆ20æ—¥ã«ãƒ¡ã‚¸ãƒ£ãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸNode.js v15ã®ç´¹ä»‹ | watilde's blog](https://blog.watilde.com/2020/10/20/node-js-v15/)
- [Node.jsã®HTTP over QUIC(HTTP/3)ã‚’è©¦ã™ | WEB EGG](https://blog.leko.jp/post/http-over-quic-on-nodejs15/)

---

### [3 things about CSS variables you might not know](https://patrickbrosset.com/articles/2020-09-21-3-things-about-css-variables-you-might-not-know/)

- å…±æœ‰è€…: nakajmg

- CSS variablesã«ã¤ã„ã¦ã®ãŠè©±
  - `var()` ã§undefinedãªå¤‰æ•°ã‚’ä½¿ç”¨ã—ãŸã¨ãã©ã†ãªã‚‹ã‹
  - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®å‹•ä½œ
  - DevToolsã¾ã‚ã‚Š
 
 ãªã©ã‚’è§£èª¬ã—ã¦ã„ã‚‹ã€‚
  
#### undefinedãªå¤‰æ•°ã‚’ä½¿ç”¨ã—ãŸæ™‚
- undefinedãªå¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ã‚‚èª­ã¿è¾¼ã¿/è§£æ/ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’å¦¨ã’ãªã„
- å¤‰æ•°ã¯ã‚«ã‚¹ã‚±ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã•ã‚Œã‚‹
- ç¶™æ‰¿ã•ã‚Œã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å ´åˆã¯ç¶™æ‰¿ã•ã‚ŒãŸå€¤ãŒä½¿ã‚ã‚Œã‚‹
- ç¶™æ‰¿ã•ã‚Œãªã„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å ´åˆã¯åˆæœŸå€¤ãŒä½¿ã‚ã‚Œã‚‹

```
.my-class {
  border: 1px solid var(--undefined-value);
  color: var(--undefined-value);
}
```

- `border` ã¯ç¶™æ‰¿ã•ã‚Œãªã„ã®ã§è¡¨ç¤ºã•ã‚Œãªã„
- `color` ã¯ç¶™æ‰¿ã•ã‚Œã‚‹ã®ã§ç¥–å…ˆã‚’ãŸã©ã£ã¦å€¤ã‚’æ¢ã™

#### ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®å‹•ä½œ
- `var()` ã«ã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ãŒã‚ã‚‹
- `var()` ã¯å…¥ã‚Œå­ã«ã§ãã‚‹

```
color: var(--theme-color, red);
```

- `--theme-color` ãŒè¦‹ã¤ã‹ã‚‰ãªã‘ã‚Œã° `red` ãŒé©ç”¨ã•ã‚Œã‚‹
- CSS variablesã‚’ä½¿ã£ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ã‚ˆã†ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ä½¿ãˆã‚‹ã‹ã‚‚ï¼Ÿ

```
color: var(--foo, var(--bar, var(--baz, var(--are, var(--you, var(--crazy)))));
```

#### DevToolsã¾ã‚ã‚Š

- å¤‰æ•°åãŒã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã•ã‚Œã‚‹
- `var()` ã«ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼ã™ã‚‹ã¨æœ€çµ‚çš„ãªå€¤ãŒç¢ºèªã§ãã‚‹
- å¤‰æ•°åãŒè‰²ã®åå‰ã®å ´åˆã«è‰²è¦‹æœ¬ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  - ãã®å€¤ãŒè‰²ã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹ã‹ã©ã†ã‹é–¢ä¿‚ãªã

---

### [Meet Face ID and Touch ID for the Web](https://webkit.org/blog/11312/meet-face-id-and-touch-id-for-the-web/)

- å…±æœ‰è€…: pirosikick

WWDC 2020ã®[Meet Face ID and Touch ID for the web](https://developer.apple.com/videos/play/wwdc2020/10670/)ã®è¨˜äº‹ç‰ˆã€‚å‹•ç”»ã‚ˆã‚Šã‚‚ã‚³ãƒ¼ãƒ‰å¤šã‚ã§è©³ç´°ã«è§£èª¬ã€‚å›³ã¯å‹•ç”»ã®ã»ã†ãŒå¤šã„ã®ã§ã€å‹•ç”»ã‚‚ãŠã™ã™ã‚ã€‚

- Web Authn APIã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨Safariä¸Šã®UIãŒã©ã†ç´ã¥ãã‹
- ä»•æ§˜ã¨é•ã†ç‚¹
  - Touch ID/Face IDã‚’ä½¿ã£ãŸWeb Authn APIã®å‘¼ã³å‡ºã—ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ãŒå¿…è¦
  - äº’æ›æ€§ã®ãŸã‚ã€Touch ID/Face IDä»¥å¤–ã‚’ä½¿ã£ãŸWeb Authn APIã®å‘¼ã³å‡ºã—ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ãŒä¸è¦
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã¨ã¯
    - `touchend`, `click`, `doubleclick`ç­‰ã®ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å†…
    - ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å†…ã‹ã‚‰å‘¼ã³å‡ºã—ãŸXHRã€Fetch APIã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å†…
    - Readable Streamã¯ã¾ã æœªå¯¾å¿œ
- Apple Anonymous Attestationã«ã¤ã„ã¦

iPhoneãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ãƒãƒ”ãƒ¥ãƒ©ãƒ¼ãªFace IDãŒWebã§ä½¿ãˆã‚‹ã“ã¨ã§Web Authnã®æ™®åŠãŒé€²ã¿ãã†ã¨æ€ã„ã¾ã—ãŸã€‚

---

### [Webpack 5 release (2020-10-10)](https://webpack.js.org/blog/2020-10-10-webpack-5-release/)
- å…±æœ‰è€…: @\_\_sakito\_\_


å‚ç…§ï¼š[Webpack 5 release (2020-10-10)](https://webpack.js.org/blog/2020-10-10-webpack-5-release/)

10/10 ã« webpack 5 ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸ ğŸ‰

webpack 5 ã®ãƒªãƒªãƒ¼ã‚¹ã¯è¡Œã‚ã‚ŒãŸãŒã€ã¾ã ãƒã‚°ãŒå¤šãã‚ã‚Šã€webpack ã§ä½¿ç”¨ã™ã‚‹ loader ã‚„ plugin ã¯å¯¾å¿œãŒè¿½ã„ã¤ã„ã¦ã„ã¾ã›ã‚“ã€‚  
ãƒ‘ãƒƒã¨[webpack 5 é–¢é€£ã® Issue](https://github.com/webpack/webpack/issues?q=is%3Aissue+is%3Aopen+label%3Awebpack-5)ã‚’çœºã‚ã‚‹ã ã‘ã§ã‚‚ã€ã¾ã å¤šãã®å•é¡ŒãŒã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚  
ãªã®ã§ã€webpack 5 ã‚’ä½¿ç”¨ã™ã‚‹ã®ã¯å®‰å…¨ã«ã„ããŸã‘ã‚Œã° 1,2 ãƒ¶æœˆã»ã©å¾…ã£ã¦ã‚‚ã‚ˆã„ã¨æ€ã„ã¾ã™ã€‚
ã„ã¾ã¯ã“ã®ãƒã‚°å¯¾å¿œã«ã‚ˆã‚Šã™ã§ã« webpack ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ 5.2.0 ã«ãªã£ã¦ã„ã¾ã™ã€‚

### [webpack-dev-server](https://github.com/webpack/webpack-dev-server)

ç¾åœ¨ã® webpack-dev-server ã¯ webpack v5 å¯¾å¿œã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãŒã¾ã ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ãªã„ã®ã§ã€å‹•ã‹ãªã„ã‚±ãƒ¼ã‚¹ãŒä½•ç‚¹ã‹ã‚ã‚Šã¾ã™ã€‚

- [webpack cli v4 ã¨ webpack-dev-server ã‚’çµ„ã¿åˆã‚ã›ãŸæ™‚ã«èµ·ãã‚‹å•é¡Œã«ã¤ã„ã¦ã® Issue](https://github.com/webpack/webpack-dev-server/issues/2759)

- [browserslist ä½¿ç”¨æ™‚ã®ãƒã‚°](https://github.com/webpack/webpack-dev-server/issues/2758)

### [webpack-cli](https://github.com/webpack/webpack-cli)

webpack v5 å¯¾å¿œã®ãŸã‚[v4 ã®ãƒªãƒªãƒ¼ã‚¹](https://github.com/webpack/webpack-cli/releases/tag/webpack-cli%404.0.0)ã¯ã•ã‚Œã¦ã„ã¾ã™ãŒã€ä¸Šè¨˜ã§ã‚‚æ›¸ã„ã¦ã„ã‚‹é€šã‚Šã€webpack dev server ã¨çµ„ã¿åˆã‚ã›ã‚‹ã¨ãƒã‚°ãŒã‚ã‚Šã¾ã™ã€‚

webpack cli v4 ã‹ã‚‰ webpack-dev-server ã®èµ·å‹•ã‚’`webpack serve`ã‚³ãƒãƒ³ãƒ‰ã«çµ±åˆã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚
[webpack serve ã‚³ãƒãƒ³ãƒ‰ã®æ¡ˆå†…ã‚’ä¿ƒã™ã‚¨ãƒ©ãƒ¼æ–‡ã®å®Ÿè£…](https://github.com/webpack/webpack-dev-server/pull/2772)

æ–°æ©Ÿèƒ½ã¨ã—ã¦`webpack --analyze`ã‚³ãƒãƒ³ãƒ‰ã§ã€[webpack-bundle-analyzer](https://github.com/webpack-contrib/webpack-bundle-analyzer)ã‚’ä½¿ç”¨ã—ã¦ã€å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã‚’å¯è¦–åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾¿åˆ©ã€‚

## ä¸»ãªå¤‰æ›´ç‚¹

https://webpack.js.org/blog/2020-10-10-webpack-5-release/#major-changes-removals

ã“ã®ã‚ˆã†ãªå¤‰æ›´ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚

- æ°¸ç¶šçš„ãªã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°
- TS ã®å¯¾å¿œã§`@types/webpack`ãŒä¸è¦ã«ãªã‚Šã€`import { WebpackOptionsNormalized } from 'webpack';` ã§å‹ã‚’ import ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚(ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ webpack.config.ts ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹)
- Tree Shaking ã®æœ€é©åŒ–ãŒå…¥ã‚Šãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºç¸®å°ã«æœŸå¾…ã§ãã‚‹
- CommonJs ã® Tree Shaking å¯¾å¿œ
- css ã® chunk ãŒå¯èƒ½ã«ãªã£ãŸ([MiniCssExtractPlugin](https://webpack.js.org/plugins/mini-css-extract-plugin/)ä½¿ç”¨æ™‚ã«ã§ãã‚‹)

ã“ã“ã§ã¯ç‰¹ã«å¤§ããªç ´å£Šçš„å¤‰æ›´ã‚’ 2 ã¤ã»ã©ç´¹ä»‹ã—ã¾ã™ã€‚

### Node.js ã® polyfill ã‚’è‡ªå‹•ã§æŒ¿å…¥ã—ãªããªã£ãŸ

webpack ã‚’ä½¿ç”¨ã™ã‚Œã°ã€Node.js ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ä½¿ç”¨ã—ã€è‡ªå‹•ã§ polyfill ã‚’æŒ¿å…¥ã—ã¦ãã‚Œã¦ã„ã¾ã—ãŸã€‚

ä»Šå¾Œ webpack ã¯ Web ã§å‹•ä½œã™ã‚‹ã‚³ãƒ¼ãƒ‰ã«ç„¦ç‚¹ã‚’å½“ã¦ã¦ã„ããŸã‚ã€Node.js ã® polyfill ãŒãƒãƒ³ãƒ‰ãƒ«ã«å«ã¾ã‚Œã€çµæœçš„ã«ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºãŒãƒ‡ã‚«ããªãã‚‹ã“ã¨ã‚’æœ›ã¾ãªã„ã‚ˆã†ã«ãªã£ãŸã®ã§ã€
è‡ªå‹•ã§ polyfill ã‚’æŒ¿å…¥ã—ãªããªã‚Šã¾ã™ã€‚

polyfill ã‚’æŒ¿å…¥ã—ãŸã„å ´åˆã¯[webpack/node-libs-browser](https://github.com/webpack/node-libs-browser)ã‚’å‚ç…§ã—ã¦ã€è‡ªå‰ã§æŒ¿å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã¾ãŸã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ Node.js ã«ä¾å­˜ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å¯¾å¿œã‚’å¾…ã¤ã‹ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰äº’æ›ã®ã‚ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

`global`,`__filename`,`__dirname`ã‚‚ webpack ã®è¨­å®šã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ`false`ã«å¤‰æ›´ã•ã‚Œã‚‹ã®ã§ã€ä½¿ç”¨ã—ãŸã„å ´åˆã¯æ˜ç¤ºçš„ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒä¸€éƒ¨ ES2015 ã«ãªã£ãŸ

webpack ãŒç”Ÿæˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ãŒä¸€éƒ¨ ES2015 ã«ãªã£ãŸã®ã§ã€æ˜ç¤ºçš„ã« es5 ã¸ã®å¯¾å¿œãŒå¿…è¦ã«ãªã‚Šã¾ã—ãŸã€‚
browserslist ã®ã‚µãƒãƒ¼ãƒˆãŒå«ã¾ã‚ŒãŸã®ã§ã€browserslist ã®è¨­å®š or webpack ã®è¨­å®šã‚’å¤‰ãˆã‚‹ã€ï¼’ã¤ã®é¸æŠè‚¢ãŒã‚ã‚Šã¾ã™ã€‚

- webpack ã®è¨­å®š

webpack.config.js

```
module.exports = {
  target: ['web','es5']
};
```

- browserslist ã®è¨­å®š

.browserslistrc

```
last 1 version
ie >= 11
```

package.json

```
  "browserslist": [
    "last 1 version",
    "> 1%",
    "ie >= 11"
  ]
```

---

### [React v17.0.1](https://github.com/facebook/react/blob/master/CHANGELOG.md#1701-october-22-2020)

- å…±æœ‰è€…: @koh110

ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå†…å®¹ã¨ã—ã¦ã¯ IE11 ã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹å•é¡Œã‚’ä¿®æ­£ã—ãŸã ã‘ã§ã™ã€‚

Ref: https://github.com/facebook/react/pull/20071

`Array.fill` ã¯ IE11 ã§å‹•ã‹ãªã„ã®ã§ãã®ä¿®æ­£ã€‚

```diff
- return new Array(TotalLanes).fill(initial);
+ const laneMap = [];
+ for (let i = 0; i < TotalLanes; i++) {
+   laneMap.push(initial);
+ }
+ return laneMap;
```

é¢ç™½ã„ã¨æ€ã£ãŸã®ã¯ã€é…åˆ—ã®åˆæœŸåŒ–æ–¹æ³•ã«ã‚ˆã£ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå¤‰ã‚ã‚‹ã®ã§ `new Array(length)` ã‚’é¿ã‘ãŸã“ã¨ã€‚
https://v8.dev/blog/elements-kinds#avoid-creating-holes

```javascript
// ã“ã‚Œã¯ã‚ˆããªã„
const array = new Array(3);
array[0] = "a";
array[1] = "b";
array[2] = "c";

// åˆæœŸåŒ–ã™ã‚‹ãªã‚‰ã“ã®ã»ã†ãŒã‚ˆã„
const array = ["a", "b", "c"];

// åˆæœŸåŒ–ã™ã‚‹è¦ç´ æ•°ãŒã‚ã‹ã‚‰ãªã„ã¨ãã¯ push ã‚’ä½¿ã†
const array = [];
array.push(someValue);
array.push(someOtherValue);
```

https://v8.dev/blog/elements-kinds#packed-vs.-holey-kinds

- é…åˆ—ã®è¦ç´ ã«ã¯ `PACKED_ELEMENTS(é€£ç¶šã™ã‚‹è¦ç´ )` ã¨ `HOLEY_ELEMENTS(ç©´ã‚ãè¦ç´ )` ãŒã‚ã‚‹
- `PACKED` ã®ã»ã†ãŒ `HOLEY` ã‚ˆã‚Šé…åˆ—æ“ä½œãŒåŠ¹ç‡çš„
- é€”ä¸­ã§é…åˆ—ã«è¦ç´ ã‚’é£›ã°ã—æŒ¿å…¥ã™ã‚‹ã¨ `PACKED` ã‹ã‚‰ `HOLEY` ã«ãªã‚‹ï¼ˆä¸å¯é€†ï¼‰

çŸ¥ã‚‰ãªã‹ã£ãŸã®ã§è¨˜äº‹ä¸­ã«ã‚ã‚‹é…åˆ—ã®ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ãªã©ã‚’ãã‚Œãã‚Œè©¦ã—ã¦ã¿ãŸã€‚é€šå¸¸ã®ä½¿ã„æ–¹ã§ã‚ã‚Œã°ã»ã¼èª¤å·®ãƒ¬ãƒ™ãƒ«ã€‚ï¼ˆè¨˜äº‹ä¸­ã«ã‚‚è¨˜è¼‰ãŒã‚ã‚‹ï¼‰
https://gist.github.com/koh110/13e3e8432b0abad9501b551e46e30b3f

(è¨˜äº‹ä¸­ã§ã¯é€”ä¸­ã«é‡ã„ if æ–‡ãªã©ãŒã‚ã‚‹å ´åˆã«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ issue ãŒå‡ºã‚‹ã‚‰ã—ã„ã€‚æ¤œè¨¼ã‚³ãƒ¼ãƒ‰ãŒã†ã¾ãæ›¸ã‘ãªã„)

æ¤œè¨¼ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹é™ã‚Šã§ã¯ `new Array().map` ã§ã‚ˆã•ãã†ã«è¦‹ãˆã¦ã—ã¾ã†ãŒã€ãªã«ã‹è¦‹è½ã¨ã—ã¦ã„ã‚‹ã‚ˆã†ãªæ°—ãŒã™ã‚‹ã€‚

Ref:

[PACKED_ELEMENTS ã«ã¤ã„ã¦](https://medium.com/sumup-engineering/optimize-your-js-code-using-googles-v8-internals-49955fd7d4a5)
[Holy Array ã«ã¤ã„ã¦](https://dev.to/voodooattack/the-holey-array-problem-3pg8)
[babel ã§ã®åŒæ§˜ã®è­°è«–](https://github.com/babel/babel/issues/6233)

`new Array(n)` ã¯å¸¸ã« HOLEY_ELEMENTS ã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ã«èª­ã¿å–ã‚Œã‚‹ã€‚

åˆæœŸç”Ÿæˆæ™‚ã®é€Ÿåº¦ã«ã¤ã„ã¦ã¯è§¦ã‚Œã¦ã„ãªã„ã®ã§ã€é€”ä¸­ã®é…åˆ—æ“ä½œãŒã‚ã£ãŸå ´åˆã« PACKED_ELEMENTS ã®ã¾ã¾ã«ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„ã¨ã„ã†æ„å‘³åˆã„ãªã‚‰ç´å¾—ã§ãã‚‹ã€‚
TypeScript ã˜ã‚ƒãªã„ã®ã§ç”Ÿæˆã•ã‚ŒãŸé…åˆ—ã®ä½¿ã„æ–¹ã‚’å¼·åˆ¶ã§ããªã„ã®ã§ã€åŠ¹æœãŒã©ã“ã¾ã§ã‚ã‚‹ã‹ã¨è€ƒãˆã‚‹ã¨åˆæœŸç”Ÿæˆã®ã‚³ã‚¹ãƒˆã§åˆ‡ã‚Šåˆ†ã‘ã‚‹ä½™åœ°ã¯ã‚ã‚Šãªæ°—ãŒã™ã‚‹ã€‚ï¼ˆä»Šå›ã¯é•·ã• 31 ã®å›ºå®šé•·é…åˆ—ãªã®ã§å¤šåˆ†èª¤å·®ï¼‰

ãƒ¡ãƒ¢ãƒªã®ä½¿ç”¨é‡ã«å·®ãŒå‡ºã‚‹ã‹ã¨æ€ã£ãŸã‘ã©ã€fill ã®ã»ã†ãŒå°‘ã—å°‘ãªã„ï¼ˆèª¤å·®ç¨‹åº¦ï¼‰
https://gist.github.com/koh110/4c77dbebccfc074ac7bb1764423d6803

[V8 ã®é–‹ç™ºè€…æ›°ãå¿ƒé…ã™ã‚‹ã»ã©ã®å·®ã§ã¯ãªã„ã€‚](https://stackoverflow.com/a/56949715)

ã€ŒDon't optimize for V8, let V8 optimize for you!ã€

Ref: [PACKED ã®ç¢ºèªã®ä»•æ–¹](https://slidrio-decks.global.ssl.fastly.net/1259/original.pdf?1521622174)

æœ¬ç­‹ã¨ã¯ãšã‚Œã‚‹ãŒã€Holy Array ã«ã¤ã„ã¦ã®ãƒ–ãƒ­ã‚°ã«ã‚ã‚‹ã‚ˆã†ã«ä¸­èº«ãŒå®Ÿè³ªçš„ã« DICTIONARY_ELEMENTS ã«ãªã£ã¦ã—ã¾ã†ã‚ˆã†ãªé…åˆ—ã®å ´åˆã€JSON.stringify ã§ãƒ¡ãƒ¢ãƒªä½¿ç”¨ãŒè·³ã­ä¸ŠãŒã£ã¦ã—ã¾ã†ã®ã¯ã†ã£ã‹ã‚Šã‚„ã£ã¦ã—ã¾ã„ãã†ã§æ€–ã„ã§ã™ã‚ˆã­ã€‚

```
const arr = []
arra[0] = 0
arra[1] = 1
arra[2] = 2
JSON.stringify(arr)
// [0,1,2]

arr[9999] = 'evil'
JSON.stringify(arr)

// [0,1,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null...
```

---
