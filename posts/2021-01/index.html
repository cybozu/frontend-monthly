<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="サイボウズのフロントエンドエキスパートチームが月イチでお届けするフロントエンド情報">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="Cybozu Frontend Expert Team">
    <meta name="twitter:title" content="Cybozu Frontend Monthly #7">
    <meta name="twitter:description" content="サイボウズのフロントエンドエキスパートチームが月イチでお届けするフロントエンド情報">
    <meta property="og:title" content="Cybozu Frontend Monthly #7">
    <meta property="og:description" content="サイボウズのフロントエンドエキスパートチームが月イチでお届けするフロントエンド情報">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://cybozu.github.io/frontend-monthly/img/header.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/frontend-monthly/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/frontend-monthly/icons/favicon-16x16.png">
    <meta name="generator" content="Astro v2.0.1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.21.0/themes/prism.min.css">
    <title>Cybozu Frontend Monthly #7</title>
  <link rel="stylesheet" href="/frontend-monthly/_astro/_slug_.51290768.css" />
<link rel="stylesheet" href="/frontend-monthly/_astro/_slug_.204bbb0f.css" /></head>

  <body>
    <main class="main">
      <h1 class="post-title astro-GJTNY2MX">Cybozu Frontend Monthly #7</h1><div class="markdown-body astro-GJTNY2MX">
    <img src="/frontend-monthly/img/header.png" alt="" width="659" height="229" style="height:auto;max-width:100%" class="astro-GRPV5QB7">
<h2 class="astro-GRPV5QB7">イベント概要</h2>
<p class="astro-GRPV5QB7">
  <strong class="astro-GRPV5QB7">サイボウズフロントエンドマンスリー</strong>
  は、サイボウズ社内で行っているフロントエンド情報共有会「フロントエンドウィークリー」の公開版です。
</p>
<p class="astro-GRPV5QB7">
  その月に気になったフロントエンドの情報を、サイボウズのフロントエンドエキスパートチームのメンバーが共有していきます。
</p>
<p class="astro-GRPV5QB7">
  <strong class="astro-GRPV5QB7">
    このイベントのハッシュタグは 
    <a href="https://twitter.com/search?q=%23%E3%82%B5%E3%82%A4%E3%83%9C%E3%82%A6%E3%82%BA%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9E%E3%83%B3%E3%82%B9%E3%83%AA%E3%83%BC" target="_blank" rel="noopener noreferrer" class="astro-GRPV5QB7">
      #サイボウズフロントエンドマンスリー
    </a> 
    です。
  </strong>
</p>

<div class="note astro-GRPV5QB7">
  <h3 class="astro-GRPV5QB7">※フロントエンドウィークリーとは</h3>
  <p class="astro-GRPV5QB7">
    毎週火曜の 17:00 〜 18:00
    で社内向けに行っているフロントエンドの気になる記事を紹介する会です。2016年3月15日から行われています。
    <br class="astro-GRPV5QB7">
    ハッシュタグ 
    <a href="https://twitter.com/search?q=%23%E3%82%B5%E3%82%A4%E3%83%9C%E3%82%A6%E3%82%BA%E3%83%95%E3%83%AD%E3%83%B3%E3%83%88%E3%82%A8%E3%83%B3%E3%83%89%E3%82%A6%E3%82%A3%E3%83%BC%E3%82%AF%E3%83%AA%E3%83%BC" target="_blank" rel="noopener noreferrer" class="astro-GRPV5QB7">
      #サイボウズフロントエンドウィークリー
    </a> 
    で実況しています。
  </p>
  <p class="astro-GRPV5QB7">
    zennのpublicationにてウィークリーのまとめも投稿していますので、ぜひこちらもご覧ください。
    <a href="https://zenn.dev/p/cybozu_frontend" target="_blank" rel="noopener noreferrer" class="astro-GRPV5QB7">
      https://zenn.dev/p/cybozu_frontend
    </a>
  </p>
</div>

<h3 class="astro-GRPV5QB7">開催日</h3>
<p class="astro-GRPV5QB7">2021年01月26日</p>

<h3 class="astro-GRPV5QB7">イベントページ</h3>
<p class="astro-GRPV5QB7">
  <a href="https://cybozu.connpass.com/event/202029/" target="_blank" rel="noopener noreferrer" class="astro-GRPV5QB7">
    https://cybozu.connpass.com/event/202029/
  </a>
</p>

<h3 class="astro-GRPV5QB7">配信URL</h3><p class="astro-RQUSJLQV">
  <iframe title="https://www.youtube.com/embed/MMFzKjIzdRA" width="560" height="315" src="https://www.youtube.com/embed/MMFzKjIzdRA" style="border: 0;" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="embed astro-RQUSJLQV"></iframe>

  <a href="https://www.youtube.com/watch?v=MMFzKjIzdRA" target="_blank" rel="noreferrer noopner" class="astro-RQUSJLQV">
    https://www.youtube.com/watch?v=MMFzKjIzdRA
  </a>
</p><h2 class="astro-5I3BJWE7">メンバー</h2>
<div class="members astro-5I3BJWE7">
  <div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@koba04.jpg" class="thumbnail astro-5I3BJWE7" alt="@koba04">
        <a href="https://twitter.com/koba04" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @koba04
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@pirosikick.jpg" class="thumbnail astro-5I3BJWE7" alt="@pirosikick">
        <a href="https://twitter.com/pirosikick" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @pirosikick
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@toshi__toma.jpg" class="thumbnail astro-5I3BJWE7" alt="@toshi__toma">
        <a href="https://twitter.com/toshi__toma" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @toshi__toma
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@zaki___yama.jpg" class="thumbnail astro-5I3BJWE7" alt="@zaki___yama">
        <a href="https://twitter.com/zaki___yama" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @zaki___yama
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@__sakito__.jpg" class="thumbnail astro-5I3BJWE7" alt="@__sakito__">
        <a href="https://twitter.com/__sakito__" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @__sakito__
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@shisama_.jpg" class="thumbnail astro-5I3BJWE7" alt="@shisama_">
        <a href="https://twitter.com/shisama_" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @shisama_
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@nakajmg.jpg" class="thumbnail astro-5I3BJWE7" alt="@nakajmg">
        <a href="https://twitter.com/nakajmg" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @nakajmg
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@b4h0_c4t.jpg" class="thumbnail astro-5I3BJWE7" alt="@b4h0_c4t">
        <a href="https://twitter.com/b4h0_c4t" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @b4h0_c4t
        </a>
      </div><div class="member astro-5I3BJWE7">
        <img src="/frontend-monthly/img/@__sosukesuzuki.jpg" class="thumbnail astro-5I3BJWE7" alt="@__sosukesuzuki">
        <a href="https://twitter.com/__sosukesuzuki" target="_blank" rel="noopener noreferrer" class="astro-5I3BJWE7">
          @__sosukesuzuki
        </a>
      </div>
</div>
<hr><h2>コンテンツ</h2><h3 id="javascript-アンケート周り">JavaScript アンケート周り</h3>
<ul>
<li>
<p>共有者: @__sakito__</p>
</li>
<li>
<p><a href="https://2020.stateofjs.com/en-US/">State of JS 2020</a></p>
<ul>
<li><a href="https://2020.stateofjs.com/ja-JP/">日本語訳</a></li>
</ul>
</li>
<li>
<p><a href="https://risingstars.js.org/2020/en">2020 JavaScript Rising Stars</a></p>
<ul>
<li><a href="https://risingstars.js.org/2020/ja">日本語訳</a></li>
</ul>
</li>
</ul>
<p>両方とも 2020 年の流れを把握するのに使えそうです。</p>
<p>State of JS は、ビルドが esbuild や sbowpack、フレームワークは引き続き svelte に興味持ってる人が多かったです。
しかし実際に使用してるものは、webpack などになっており、新しいものはまだプロダクションで使用するには踏み込めない印象。
各項目で色々な人が 2020 年の個人的ベストを紹介してるのが面白かった、<a href="https://github.com/atlassian/changesets">changesets</a>、<a href="https://insomnia.rest/">Insomnia</a>、<a href="https://redwoodjs.com/">Redwood</a>など知らないものを知れました。</p>
<p>2020 JavaScript Rising Stars は、あくまでスター数なので State of JS 2020 と見比べて世間がどこに注目しているか照らし合わせるとよさそうです。
各セクションで説明もあるので、なぜスター数が増えたのかもわかりやすいです。</p>
<hr>
<h3 id="dont-use-inverted-color-cues-on-toggle-buttons"><a href="https://uxmovement.com/buttons/dont-use-inverted-color-cues-on-toggle-buttons/">Don’t Use Inverted Color Cues on Toggle Buttons</a></h3>
<ul>
<li>共有者: @pirosikick</li>
</ul>
<p>トグルボタンでボタンの文字色と背景色を反転させた ON・OFF ボタンを作りがちだが、
色のコントラスト比が同じになるのでどちらが ON で OFF なのかわからず誤操作が増えがちなので気をつけなはれや、という内容。
ブログの画像を見ると分かりやすいですが、色の反転の代わりに奥行きで ON/OFF を表現するといいよとのことです。
最近、tailwind.css を使っていて悪い例と同じようなことをしていたので、タイムリーで参考になりました。</p>
<hr>
<h3 id="classi-にフロントエンドエキスパートチームを作った話"><a href="https://tech.classi.jp/entry/2021/01/18/103110">Classi にフロントエンドエキスパートチームを作った話</a></h3>
<ul>
<li>共有者: @nakajmg</li>
</ul>
<p>Classi さんがフロントエンドエキスパートチームを作った話。
弊チームを参考にしてくれたとのことで、私達の活動が界隈に影響を与えられていると思うと嬉しいですね。</p>
<p>記事中では<a href="https://giamir.com/frontendops">FrontendOps</a>について触れており、フロントエンドの運用が開発者だけの関心事ではなく、チーム全員にとって重要であると説明しています。
今後ますますフロントエンドの運用は重要な関心事となっていくと思いますので、弊フロントエンドエキスパートチームとしても真摯に向き合って行きたいです。</p>
<hr>
<h3 id="front-end-performance-checklist-2021--smashing-magazine"><a href="https://www.smashingmagazine.com/2021/01/front-end-performance-2021-free-pdf-checklist/">Front-End Performance Checklist 2021 — Smashing Magazine</a></h3>
<ul>
<li>共有者: @shisama</li>
</ul>
<p>パフォーマンスに関するチェックリストです。<br>
77 個のチェックリストがありますが、長大なので挫折しそうな人はサマライズされている <a href="https://www.dropbox.com/s/34noajrbm324iai/performance-checklist-1.4.pdf">PDF 版</a> を読んでみて気になるところは記事の方を読んでみるのが良いかと思います。</p>
<p>記事の最後には<strong>Quic Wins</strong>として 1 時間で改善できる 17 個のことを記事中からピックアップされているので、まずはこれからはじめるのも良さそうです。<br>
個人的には「パフォーマンスの文化を作る」が最初に来ているところがいいと思いました。</p>
<p>パフォーマンスに関連する話で今月知ったものもあわせて紹介しておきます。</p>
<p>この記事の中でも CoreWebVitals を使って計測する話があり、DevTools で計測したり、<a href="https://chrome.google.com/webstore/detail/web-vitals/ahfhijdlegdabablpippeagghigmibma?hl=en">Chrome 拡張</a>を使っている人が多いと思いますが、Chrome 90 からは Experimental ですが Chrome 本体でもメトリクスを常に監視できるようになるようです。<br>
<a href="https://addyosmani.com/blog/performance-hud/">AddyOsmani.com - A Performance Heads-Up Display (HUD) for Chrome</a></p>
<p>JS のサイズについては、モダンブラウザで使える JS の構文を使うことでバンドルサイズを減らせると紹介されています。<br>
JS のネイティブに置き換えることでどれくらいバンドルサイズを減らせるかをチェックするツールがあるので、試してみるといいかもしれません。<br>
<a href="https://estimator.dev/">EStimator.dev: the modern JavaScript savings calculator</a></p>
<hr>
<h3 id="agenda-for-the-80th-meeting-of-ecma-tc39"><a href="https://github.com/tc39/agendas/blob/master/2021/01.md">Agenda for the 80th meeting of Ecma TC39</a></h3>
<p>TC39 の１月のミーティングのアジェンダです。25 日~28 日にかけて行われます。</p>
<p>このミーティングでは多くのプロポーザルについての議論が行われる予定です。</p>
<h4 id="intl-系ecma402のプロポーザル"><a href="https://github.com/tc39/ecma402">Intl 系(ECMA402)</a>のプロポーザル</h4>
<ul>
<li><a href="https://github.com/tc39/proposal-intl-DateTimeFormat-formatRange">Intl.DateTimeFormat.prototype.formatRange</a> for Stage 4</li>
<li><a href="https://github.com/tc39/proposal-intl-locale-info">Intl Locale Info</a> for stage 2</li>
<li><a href="https://github.com/tc39/intl-displaynames-v2">Intl DisplayNames</a> v2 for stage 2</li>
<li><a href="https://github.com/Louis-Aime/proposal-intl-eradisplay">eraDisplay option for Intl.DateTimeFormat</a> for stage 1</li>
<li><a href="https://github.com/longlho/proposal-intl-localematcher">Intl LocaleMatcher</a> for Stage 1</li>
<li><a href="https://github.com/FrankYFTang/proposal-intl-extend-timezonename/">Extend TimeZoneName Option Proposal</a> for stage 1</li>
</ul>
<h4 id="新しい構文を追加するプロポーザル">新しい構文を追加するプロポーザル</h4>
<ul>
<li>⭐<a href="https://github.com/tc39/proposal-class-static-block">Class static Initialization Blocks</a> for Stage 3</li>
<li>⭐<a href="https://github.com/tc39/proposal-js-module-blocks">JS Module Blocks</a> for stage 2</li>
<li>⭐<a href="https://github.com/bakkot/do-expressions-v2">do expressions</a> for stage 2</li>
<li><a href="https://github.com/bakkot/proposal-async-do-expressions">async do expressions</a> for stage 1</li>
<li><a href="https://github.com/mathiasbynens/proposal-regexp-set-notation">Adopting Unicode behavior for set notation in regular expressions</a></li>
<li><a href="https://github.com/codehag/proposal-lazy-import">defer module import eval</a> for stage 1</li>
</ul>
<h4 id="新しい-api-を追加するプロポーザル">新しい API を追加するプロポーザル</h4>
<ul>
<li>⭐<a href="https://github.com/tc39/proposal-relative-indexing-method">Relative indexing method</a> for stage 4</li>
<li><a href="https://github.com/tc39/proposal-array-is-template-object">Array.isTemplateObject</a> for stage 3</li>
<li><a href="https://github.com/tc39/proposal-temporal">Temporal</a> updates</li>
<li><a href="https://github.com/tc39/proposal-resizablearraybuffer">ResizableArrayBuffer and GrowableSharedArrayBuffer</a> updates</li>
<li><a href="https://github.com/tc39/proposal-realms">Realms</a> update</li>
<li><a href="https://github.com/Kingwl/proposal-array-find-from-last">Array find from last</a> for stage 1</li>
</ul>
<h4 id="その他">その他</h4>
<ul>
<li><a href="https://github.com/tc39/proposal-private-fields-in-in">Ergonomic brand checks for private fields</a> for stage 3</li>
<li><a href="https://github.com/tc39/proposal-dynamic-code-brand-checks">Dynamic code brand checks</a> for stage 2</li>
<li><a href="https://github.com/hax/proposal-class-brand-check">class brand check</a> for stage 1</li>
<li>⭐<a href="https://github.com/tc39/proposal-json-modules">JSON modules</a> for stage 3</li>
<li><a href="https://github.com/tc39/proposal-regexp-match-indices">RegExp Match Indices</a> update</li>
</ul>
<p>数が多くて全部は紹介しきれないので、僕が個人的に気になったもの、多くの JavaScript 開発者にとって影響が大きそうなもの、かつステージが進みそうなものを紹介していきます。</p>
<details>
  <div>
<h4 id="class-static-initilization-blocks-for-stage-3">Class static initilization Blocks for Stage 3</h4>
<p><a href="https://github.com/tc39/proposal-class-static-block">https://github.com/tc39/proposal-class-static-block</a></p>
<p>これは、クラスのスタティックプロパティの初期化を行うことができるブロックの構文を導入するプロポーザルです。</p>
<p>今のクラスの仕様だと、何かしらの外部の計算に依存してスタティックプロパティを決定したいとき、クラスの中だけでは不可能でした。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> x <span class="token operator">=</span> <span class="token operator">...</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token constant">C</span><span class="token punctuation">.</span>y <span class="token operator">=</span> obj<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
  <span class="token comment">// doSomething が失敗したときのフォールバック</span>
  <span class="token constant">C</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">...</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>このプロポーザルで追加するクラススタティックブロックを使うと、このような処理をクラス内のブロックに書くことができます。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> x <span class="token operator">=</span> <span class="token operator">...</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> y<span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> obj<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">...</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h4 id="js-module-blocks-for-stage-2">JS Module Blocks for Stage 2</h4>
<p><a href="https://github.com/tc39/proposal-js-module-blocks">https://github.com/tc39/proposal-js-module-blocks</a></p>
<p>ちょっと前のマンスリーでも紹介しました。</p>
<p>インラインでモジュールを定義できる新しい式の構文を導入するプロポーザル。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">const</span> moduleBlock <span class="token operator">=</span> module <span class="token punctuation">{</span>
  <span class="token keyword">export</span> <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> moduleExports <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span>moduleBlock<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">assert</span><span class="token punctuation">(</span>moduleExports<span class="token punctuation">.</span>y <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>module 式で作ったモジュールは、Worker コンストラクタにそのまま渡すことができます。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">let</span> workerCode <span class="token operator">=</span> module <span class="token punctuation">{</span>
  <span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> mod <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">postMessage</span><span class="token punctuation">(</span>mod<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>workerCode<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">alert</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>module <span class="token punctuation">{</span> <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">"hello!"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>著者のツイートからすでにステージ 2 にあがっているようです。</p>
<h4 id="do-expression-for-stage-2"><code>do</code> expression for Stage 2</h4>
<p><a href="https://github.com/bakkot/do-expressions-v2">https://github.com/bakkot/do-expressions-v2</a></p>
<p>長らく Stage 1 のままだった <code>do</code> expression です。</p>
<p>ブロックの中で最後の評価されたものが式の結果になります。また、変数のスコープは <code>do</code> のブロックの中で閉じます。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">do</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> tmp <span class="token operator">=</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  tmp <span class="token operator">*</span> tmp <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>読みにくいネストした三項演算子の代わりに <code>if else</code> で書けるようになります。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">do</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>特に、JSX などの中に書くと便利です。</p>
<pre class="language-jsx"><code is:raw="" class="language-jsx"><span class="token keyword">return</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>nav</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">Home</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span><span class="token keyword">do</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>loggedIn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">LogoutButton</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span><span class="token class-name">LoginButton</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>nav</span><span class="token punctuation">></span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4 id="relative-indexing-method">Relative indexing method</h4>
<p><a href="https://github.com/tc39/proposal-relative-indexing-method">https://github.com/tc39/proposal-relative-indexing-method</a></p>
<p><code>Array.prototype.at</code> のことです。</p>
<p>配列の後ろから要素を取得するのが楽になります。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"d"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "a"</span>
arr<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "b"</span>
arr<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "d"</span></code></pre>
<h4 id="json-modules-for-stage-3">JSON modules for Stage 3</h4>
<p><a href="https://github.com/tc39/proposal-json-modules">https://github.com/tc39/proposal-json-modules</a></p>
<p>JSON を JavaScript からモジュールとして読み込むときの挙動についての仕様です。</p>
<p>もともとは、<a href="https://github.com/tc39/proposal-import-assertions/">Import Assertions</a>の一部でしたが別の仕様として切り出されました。</p>
<p>ブラウザ上では JSON modules を使う場合は、セキュリティ上の都合から Import Assertions の構文を使って import する必要があります。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">import</span> json <span class="token keyword">from</span> <span class="token string">"./foo.json"</span> <span class="token keyword">assert</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"json"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"foo.json"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">assert</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"json"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>ただ、これはブラウザ特有のセキュリティの問題なので、JSON modules を import するときにアサートを必須にするかどうかは各ランタイムに委ねられています(Import Assertions の構文を解釈できる必要はある)。</p>
<p>次のような JSON を考えます。</p>
<pre class="language-json"><code is:raw="" class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"foo"</span><span class="token operator">:</span> <span class="token string">"ふー"</span><span class="token punctuation">,</span>
  <span class="token property">"bar"</span><span class="token operator">:</span> <span class="token string">"ばー"</span>
<span class="token punctuation">}</span></code></pre>
<p>これを JavaScript から import するときは default export として解釈します。</p>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token keyword">import</span> json <span class="token keyword">from</span> <span class="token string">"./foobar.json"</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ふー</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ばー</span></code></pre>
<p>JSON のキーには JavaScript の識別子として妥当でないものを使用できるため、named export はサポートされていません。</p>
<pre class="language-json"><code is:raw="" class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"32"</span><span class="token operator">:</span> <span class="token string">"さんじゅうに"</span>
<span class="token punctuation">}</span></code></pre>
<pre class="language-js"><code is:raw="" class="language-js"><span class="token comment">// 数字は識別子として認められていない</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token number">32</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"numbers.json"</span><span class="token punctuation">;</span></code></pre>
  </div>
</details>
<hr>
<h3 id="enabling-popups---microsoftedgemsedgeexplainers"><a href="https://github.com/MicrosoftEdge/MSEdgeExplainers/blob/main/Popup/explainer.md">Enabling Popups - MicrosoftEdge/MSEdgeExplainers</a></h3>
<ul>
<li>共有者: @zaki___yama</li>
</ul>
<p><a href="https://cybozu.github.io/frontend-monthly/posts/2020-08">以前の Frontend Monthly</a>で ”<a href="https://github.com/MicrosoftEdge/MSEdgeExplainers/blob/main/ControlUICustomization/explainer.md">Enabling Custom Control UI</a>” というプロポーザルを紹介したんですが、その続編みたいなプロポーザルです。
といってもその後の動向を熱心にウォッチしてたわけではなく、例によって Edge の PM の<a href="https://twitter.com/soMelanieSaid/status/1352324867941568512?s=20">ツイート</a> から知りました。</p>
<h4 id="概要">概要</h4>
<ul>
<li><code>&#x3C;popup></code> という新しい HTML 要素の提案です</li>
<li>他の HTML 要素と同じようにマークアップを書き、 <code>show()/hide()</code> メソッドで表示／非表示を制御します</li>
</ul>
<pre class="language-html"><code is:raw="" class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">aria-haspopup</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">aria-controls</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuPopup<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuButton<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  Menu
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>popup</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuPopup<span class="token punctuation">"</span></span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menu<span class="token punctuation">"</span></span> <span class="token attr-name">anchor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>menuButton<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token comment">&#x3C;!-- Markup for menuitems goes here --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>popup</span><span class="token punctuation">></span></span></code></pre>
<pre class="language-javascript"><code is:raw="" class="language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"menuButton"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"menuPopup"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<ul>
<li><code>popup</code> は独立した要素の可能性もあるし、combobox のようなより大きな複合的な(composited)コンポーネントの一部の可能性もあります</li>
</ul>
<h4 id="面白いと思ったポイントいくつか">面白いと思ったポイントいくつか</h4>
<ul>
<li>popup は以下の挙動をする。これらの挙動をプロポーザル中では “light dismiss” と表現している
<ul>
<li>ユーザーが Escape キーを押した</li>
<li><code>popup</code> またはそのアンカー要素の layout が変更された</li>
<li>フォーカスが外れた</li>
</ul>
</li>
<li>[<a href="https://github.com/MicrosoftEdge/MSEdgeExplainers/blob/main/Popup/explainer.md#anchored-positioning">Anchored positioning</a>] popup の位置を他の要素に紐付けられるよう、CSS anchored positioning scheme という別のプロポーザルも策定予定。ただ現状も <code>anchor</code> 属性を指定すると別の要素に紐付けることができる</li>
<li>[<a href="https://github.com/MicrosoftEdge/MSEdgeExplainers/blob/main/Popup/explainer.md#alternate-solutions-considered">Alternate Solutions Considered</a>] 別のソリューションとして <code>&#x3C;dialog></code> 要素の拡張も考えたけど、popup と dialog で期待する機能が違うのでやめた。たとえば
<ul>
<li>popup は軽量な UI で、ユーザーが他の UI を操作したときなどに自動的に消えてほしいけど、dialog は一般的にユーザーが明示的に閉じないと消えない</li>
<li>popup は一度に 1 つしか表示できないが、dialog はそうとは限らない</li>
<li>dialog を表示したとき popup は非表示になるべきだけど、逆はそうとは限らない</li>
</ul>
</li>
<li>[<a href="https://github.com/MicrosoftEdge/MSEdgeExplainers/blob/main/Popup/explainer.md#areas-for-exploration">Areas for exploration</a>] 表示・非表示を手続き的に書かないといけないのかーと思ったけど、宣言的に書けるような属性も検討するかも</li>
</ul>
<hr>
<h3 id="how-we-improved-smashingmag-performance"><a href="https://www.smashingmagazine.com/2021/01/smashingmag-performance-case-study/">How We Improved SmashingMag Performance</a></h3>
<ul>
<li>共有者: @b4h0-c4t</li>
</ul>
<h4 id="一行まとめ">一行まとめ</h4>
<p>JAMStack 上で React を使って構築した Web サイトのパフォーマンスを最適化し、Core Web Vitals のメトリクスを改善した手法の話。</p>
<h4 id="序文">序文</h4>
<p>Web パフォーマンスについての話の多くはオーバーホールから始まる。
一方で、時間経過による機能追加の結果コードの断片化やサードパーティスクリプトの読み込み高速化のための “fourth-party” スクリプトが入ってしまう。</p>
<p>実際、smashing 社もパフォーマンスへの目標をしばしば忘れていた結果、Lighthouse スコアがボロボロになっていた。</p>
<h4 id="thats-where-we-were">That’s Where We Were</h4>
<p>対象サービス(おそらくブログ)は JAMStack 上で Hugo + React を用いて構築されている。
記事のビルドには 6 分近く掛かり、CSS の注入、Webpack のコード分割、広告・昨日の動的挿入 RSS 生成、エッジに配信するための AB テスト等のビルドプロセスが走っていた。</p>
<h4 id="identifying-bottlenecks">Identifying Bottlenecks</h4>
<p>ボトルネックを特定するためにいくつかのパフォーマンス評価を実施した。</p>
<p>LCP の結果、5-9 月あたりからパフォーマンスの悪化が見られた。
この時期はナビゲーションバーのリリースを実施していたことから、この指標からボトルネックを特定するのは容易だった。</p>
<p>サービスのリクエストマップを調べた当初は特に問題はなさそうだった。
しかし、特定の条件下で DOM のサイズが爆発的に大きくなることを発見した。
主要なページのみを計測対象とした結果発見できていなかったが、埋め込み等が多く用いられている記事を計測した際は膨大なリクエストが行き来していることがわかった。</p>
<h4 id="やったこと">やったこと</h4>
<ul>
<li>head の読み込み順序改善</li>
<li>特に重要な CSS の手動生成</li>
<li>Web フォントの読込変更</li>
<li>モノリシックな JS の特定と分解</li>
<li>サードパーティコンテンツの適切な割り当て(レイアウト)</li>
<li>体験の向上(AVIF 生成や著作画像のプリロード等)</li>
</ul>
<h4 id="どうなったか">どうなったか</h4>
<ul>
<li>Lighthouse のスコアはかなり改善した。
インタラクティブタイムとブロッキングタイムが今後の課題で、CSS サイズの縮小やモバイル用のバンドルも検討している。</li>
</ul>
<hr>
<h3 id="upgrading-devtools-architecture-to-the-modern-web"><a href="https://youtu.be/BHogHiiyuQk">Upgrading DevTools’ architecture to the modern web</a></h3>
<ul>
<li>共有者: @toshi__toma</li>
</ul>
<p>2020 年の Chrome DevSummit の動画で、Chrome DevTools が取り組んだアーキテクチャの移行についての動画。</p>
<p>取り組んだもの</p>
<ul>
<li>モジュールシステム
<ul>
<li>Custom Module System を JavaScript Modules へ</li>
</ul>
</li>
<li>型システム
<ul>
<li>Closure Compiler を TypeScript Compiler へ</li>
</ul>
</li>
<li>ビルドシステム
<ul>
<li>Python Scripts を Rollup へ</li>
</ul>
</li>
<li>コンポーネント
<ul>
<li>独自の Custom Components を Web Components へ</li>
</ul>
</li>
</ul>
<p>DevTools は、大規模で歴史の長い Web アプリケーションなので、それらの移行をどのように進めたのか、移行での学びなどがまとまってる。
移行の計画・実施・管理の 3 つについて説明されていて、とても参考になるものが多かったです。</p>
<hr><h2 class="astro-ZLQ3LPZK">フロントエンドエキスパートチームについて</h2>
<div class="wrapper astro-ZLQ3LPZK">
  <script data-id="0efec8a9dd224baebfb2aaf30fbe9a28" data-ratio="1.33333333333333" src="//speakerdeck.com/assets/embed.js" class="speakerdeck-embed"></script>
</div>

<p class="astro-ZLQ3LPZK">
  <a href="https://speakerdeck.com/cybozuinsideout/frontendexpert-team" target="_blank" rel="nofollow noopener noreferrer" class="astro-ZLQ3LPZK">
    https://speakerdeck.com/cybozuinsideout/frontendexpert-team
  </a>
</p>
  </div>
    </main>

    <footer class="footer">
      <a href="/frontend-monthly/">Cybozu Frontend Monthly</a>
    </footer>
  
</body></html>